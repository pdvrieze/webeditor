<script src="bower_components/jquery/jquery.min.js"></script>
<script>
var str = '<pe:processModel name="adv" xmlns:pe="http://adaptivity.nl/ProcessEngine/"><pe:activity id="c25" x="112" y="184" label="123" predecessor="c29"><pe:message type="application/soap+xml" serviceNS="http://adaptivity.nl/userMessageHandler" serviceName="userMessageHandler" endpoint="internal" operation="postTask"><env:Envelope xmlns:env="http://www.w3.org/2003/05/soap-envelope" encodingstyle="http://www.w3.org/2003/05/soap-encoding"><env:Body><umh:postTask xmlns:umh="http://adaptivity.nl/userMessageHandler"><umh:repliesParam><jbi:element xmlns:jbi="http://adaptivity.nl/ProcessEngine/activity" value="endpoint"></jbi:element></umh:repliesParam><umh:taskparam><umh:task><jbi:attribute xmlns:jbi="http://adaptivity.nl/ProcessEngine/activity" value="instancehandle" name="instancehandle"></jbi:attribute><jbi:attribute xmlns:jbi="http://adaptivity.nl/ProcessEngine/activity" value="handle" name="remotehandle"></jbi:attribute><jbi:attribute xmlns:jbi="http://adaptivity.nl/ProcessEngine/activity" value="owner" name="owner"></jbi:attribute><umh:item type="label"></umh:item><umh:item type="text"></umh:item></umh:task></umh:taskparam></umh:postTask></env:Body></env:Envelope></pe:message><pe:define name="d_label">asd</pe:define><pe:result xpath="/values/value/text()" name="r_value"></pe:result><pe:define name="d_value">asdf</pe:define><pe:define name="d_label">asdf</pe:define><pe:result xpath="/values/value/text()" name="r_value"></pe:result><pe:define name="d_value">d_asdf</pe:define></pe:activity><pe:start id="c29" x="40" y="144"></pe:start><pe:end id="c33" x="184" y="128" predecessor="c25"></pe:end></pe:processModel>';


function beginQuoteFileUnquoteUpload(data)
{
    // Define a boundary, I stole this from IE but you can use any string AFAIK
    var boundary = "---------------------------7da24f2e50046";
    var xhr = new XMLHttpRequest();
    var body = '--' + boundary + '\r\n'
             + 'Content-Disposition: form-data; name="processUpload"; '
             + 'filename="temp.xml"\r\n'
             + 'Content-type: plain/text\r\n\r\n'
             + data + '\r\n'
             + '--' + boundary + '--';

             console.log(body);

    xhr.open("POST", "http://localhost/ProcessEngine/processModels", true);
    xhr.setRequestHeader(
        "Content-type", "multipart/form-data; boundary="+boundary
    );
    xhr.onreadystatechange = function ()
    {
        if (xhr.readyState == 4 && xhr.status == 200)
            alert("File uploaded!");
    }
    xhr.send(body);
}

beginQuoteFileUnquoteUpload(str);

</script>
